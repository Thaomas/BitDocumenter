<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Byte Visualizer • BitDocumenter</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="styles.css" />
</head>
<body>
	<header class="site-header">
		<div class="container">
			<h1 class="logo">BitDocumenter</h1>
		</div>
	</header>

	<main id="byteApp">
		<section class="section">
			<div class="container">
				<div class="section-head">
					<h2>Interactive Byte Visualizer</h2>
					<div class="options-root">
						<button id="optionsToggle" class="btn-secondary options-toggle" type="button" aria-haspopup="true" aria-expanded="false">
							Options
						</button>
						<div id="optionsMenu" class="options-menu" role="dialog" aria-modal="false" hidden>
							<div class="options-panel">
								<div class="options-panel-head">
									<h4>Options</h4>
									<button id="closeOptionsBtn" class="btn-icon" type="button" aria-label="Close options panel">&times;</button>
								</div>
								<div class="options-panel-body">
									<label class="field">
										<span>Bit order</span>
										<select id="bitOrder" class="group-type">
											<option value="msb">MSB → LSB</option>
											<option value="lsb">LSb → MSb</option>
										</select>
									</label>
									<label class="field">
										<span>Byte order</span>
										<select id="byteOrder" class="group-type">
											<option value="msbyte">Most Significant Byte → Least Significant Byte</option>
											<option value="lsbyte">Least Significant Byte → Most Significant Byte</option>
										</select>
									</label>
									<p class="muted">Choose whether bit grouping reads from MSB or LSB first.</p>
								</div>
							</div>
						</div>
					</div>
				</div>
				<p class="muted">Click any bit to toggle between 0 and 1. Add more bytes as needed.</p>

				<div class="controls">
					<input id="bytesHexInput" class="text-input" type="text" placeholder="Hex bytes (e.g., 0xFA3)" aria-label="Hex bytes input" />
					<span class="divider"></span>
					<label class="toggle-select">
						<input id="selectMode" type="checkbox" />
						<span>Test bits</span>
					</label>
					<input id="groupLabelInput" class="text-input" type="text" placeholder="Group label (e.g., opcode)" aria-label="Group label" />
					<button id="groupSelectedBtn" class="btn-secondary" disabled>Group Selected</button>
					<button id="clearSelectedBtn" class="btn-secondary" disabled>Clear Selection</button>
					<button id="resetAllBtn" class="btn-secondary" type="button">Reset</button>
					<div class="import-export-root">
						<button id="importExportToggle" class="btn-secondary import-export-toggle" type="button" aria-haspopup="true" aria-expanded="false">
							Import / Export
						</button>
						<div id="importExportMenu" class="import-export-menu" role="dialog" aria-modal="false" hidden>
							<div class="import-export-panel">
								<div class="import-export-panel-head">
									<h4>Import / Export</h4>
									<button id="closeImportExportBtn" class="btn-icon" type="button" aria-label="Close import/export menu">&times;</button>
								</div>
								<textarea id="configBase64" class="decoder-input" spellcheck="false" placeholder="Base64 configuration"></textarea>
								<div class="import-export-actions">
									<label class="toggle-select">
										<input id="exportIncludeSetBits" type="checkbox" />
										<span>Include set bits on export</span>
									</label>
									<button id="exportConfigBtn" class="btn-secondary" type="button">Export</button>
									<button id="exportPdfBtn" class="btn-secondary" type="button">Export PDF</button>
									<button id="copyConfigBtn" class="btn-secondary" type="button">Copy</button>
									<button id="importConfigBtn" class="btn-secondary" type="button">Import</button>
								</div>
								<span id="importExportStatus" class="group-error" role="status" aria-live="polite"></span>
							</div>
						</div>
					</div>
				</div>

				<div id="bytesContainer" class="bytes-stack"></div>
				<div class="modifyContainer">
					<button id="addByteBtn" class="btn-primary">Add Byte</button>
					<button id="removeByteBtn" class="btn-secondary" hidden>Remove Last Byte</button></div>

				<div class="groups-panel">
					<h4 class="groups-title">Groups</h4>
					<div id="groupsContainer" class="groups-container"></div>
				</div>

				

				<!-- Group Settings Modal -->
				<div id="groupSettingsModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
					<div class="modal-backdrop" data-close-modal></div>
					<div class="modal-content" role="document">
						<h3 class="modal-title">Group Settings</h3>
						<div class="modal-body">
							<label class="field">
								<span>Label</span>
								<input id="gsLabel" class="text-input" type="text" placeholder="Group label" />
							</label>
							<label class="field">
								<span>Type</span>
								<select id="gsType" class="group-type">
									<option value="flags">Flags</option>
									<option value="value">Value</option>
								</select>
							</label>
							<div id="gsDecoderWrap" class="group-decoder" hidden>
								<textarea id="gsDecoder" class="decoder-input" spellcheck="false"></textarea>
								<span class="group-output">Provide function decode(bits) { ... } that returns a value.</span>
							</div>
							<div id="gsFlagsWrap" class="group-decoder" hidden>
								<label class="field">
									<span>Flags input mode</span>
									<select id="gsFlagsMode" class="group-type">
										<option value="json">JSON</option>
										<option value="fields">Fields</option>
									</select>
								</label>
								<textarea id="gsFlagsDescriptions" class="decoder-input" spellcheck="false" placeholder='{\"0\":\"Zero Flag\",\"1\":\"Sign Flag\"}'></textarea>
								<div class="field-actions">
									<button id="gsFlagsPretty" class="btn-secondary" type="button">Pretty Print</button>
								</div>
								<div id="gsFlagsFields" class="flags-fields" hidden>
									<div class="flags-fields-head">
										<span>Bit</span>
										<span>On 1</span>
										<span>On 0 (optional)</span>
										<span></span>
									</div>
									<div id="gsFlagsList" class="flags-fields-list"></div>
									<div class="flags-fields-actions">
										<button id="gsAddFlagRow" class="btn-secondary" type="button">Add Flag</button>
									</div>
								</div>
								<span class="group-output">Provide JSON mapping of bit index to description. Supports "On|Off" or {"1":"On","0":"Off"}, e.g. {"1":"Carry|No Carry","5":{"1":"Overflow","0":"No Overflow"}}.</span>
							</div>
						</div>
						<div class="modal-actions">
							<button id="gsCancel" class="btn-secondary" data-close-modal>Cancel</button>
							<button id="gsDelete" class="btn-secondary">Delete Group</button>
							<button id="gsSave" class="btn-primary">Save</button>
						</div>
					</div>
				</div>
			</div>
		</section>
	</main>

	<footer class="site-footer">
		<div class="container">
			<p>&copy; <span id="year"></span> BitDocumenter</p>
		</div>
	</footer>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
	<script src="main.js"></script>
	<script type="module" src="byte-app.js"></script>
	<noscript>This page requires JavaScript for interactivity.</noscript>
</body>
</html>

